# ==============================
# DupeTrace Configuration (overview)
# ==============================
# How to use:
# 1) Set your PostgreSQL connection under database.postgres (url/user/password).
# 2) Restart the server (recommended) after saving changes.
#
#  The requirements for PostgreSQL are already included with PaperMC,
#         you just need to provide a (remote) database
#
# About defaults:
# - Every setting below keeps a short inline comment showing its default value.
# - If unsure, you can keep the defaults; they are safe for most servers.
#
# Overview of settings:
# database.postgres.url        â€” JDBC URL to your PostgreSQL database (e.g., jdbc:postgresql://localhost:5432/dupe_trace)
# database.postgres.user       â€” Database username
# database.postgres.password   â€” Database password
# database.debug               â€” Extra verbose DB logging to console (spammy). Default: false
# broadcast-duplicates         â€” Broadcast duplicate detections to all players. Default: true
# alert-admins                 â€” Send alerts to players with dupetrace.alerts. Default: true
# auto-remove-duplicates       â€” BETA: auto-remove extra copies (use with caution). Default: true
# keep-oldest-on-dup-remove    â€” When auto-removing, keep the oldest-known copy. Default: true
# movement-grace-ms            â€” Grace window to avoid false positives during fast moves. Default: 750
# duplicate-alert-debounce-ms  â€” Minimum time between alerts for the same item. Default: 2000
# allow-creative-duplicates    â€” Allow duplicates created in Creative (still logged). Default: true
# known-items-ttl-ms           â€” TTL for in-memory tracking to cap memory usage. Default: 600000
# scan-interval                â€” Periodic scan interval in ticks (20 ticks = 1s). Default: 200
# inventory-open-scan-enabled  â€” Scan inventories when they open (more overhead). Default: true
#
# Tip: Values ending in -ms are milliseconds.

database: # DupeTrace uses PostgreSQL only!
  postgres:
    url: jdbc:postgresql://localhost:5432/dupe_trace
    user: postgres
    password: postgres
    pool-size: 10 # default: 10 (max concurrent connections, 1-50)
    connection-timeout-ms: 30000 # default: 30000 (connection timeout in milliseconds)
  debug: false # default: false

broadcast-duplicates: true # default: true
alert-admins: true # default: true

# -- BETA FEATURE --
# Automatically removing duplicates COULD in very rare cases be triggered by false positives.
auto-remove-duplicates: true # default: true
keep-oldest-on-dup-remove: true # default: true
# When above [auto-remove-duplicates: true], it keeps the oldest recorded version of the item/block

# lower number = stronger detection, but more mistakes
# higher number = weaker detection, but fewer mistakes
movement-grace-ms: 750 # default: 750
duplicate-alert-debounce-ms: 2000 # default (milliseconds): 2000
allow-creative-duplicates: true # default: true
known-items-ttl-ms: 600000 # default (milliseconds): 600000
scan-interval: 200 # default: 200

# If [inventory-open-scan-enabled: false], full inventory scans will be disabled.
# This reduces overhead Significantly on large active playerbases
inventory-open-scan-enabled: true # default: true

# ==============================
# Discord Webhook Integration
# ==============================
# Send customizable alerts to your Discord server when duplicates are detected.
# To set up: Discord Server Settings -> Integrations -> Webhooks -> New Webhook
discord:
  enabled: false # default: false
  webhook-url: "" # Your Discord webhook URL

  # Bot appearance in Discord
  username: "DupeTrace" # default: DupeTrace
  avatar-url: "" # Custom avatar URL (leave empty for default Discord avatar)

  # Embed customization
  embed:
    # Color for duplicate alerts (hex format with # or without, e.g., "#FF0000" or "FF0000")
    color: "#FF0000" # default: #FF0000 (red)

    # Title template - supports placeholders: {player}, {item_type}, {uuid_short}, {uuid_full}
    title: "ðŸš¨ Duplicate Item Detected" # default: ðŸš¨ Duplicate Item Detected

    # Description template (optional) - supports same placeholders as title
    # Leave empty for no description
    description: ""

    # Choose which fields to display in the embed
    show-player: true # default: true
    show-item-type: true # default: true
    show-item-uuid: true # default: true (shows shortened UUID)
    show-full-uuid: false # default: false (show full UUID instead of shortened)
    show-location: true # default: true
    show-timestamp: true # default: true

    # Custom field names (leave empty for defaults)
    field-name-player: "Player" # default: Player
    field-name-item-type: "Item Type" # default: Item Type
    field-name-uuid: "Item UUID" # default: Item UUID
    field-name-location: "Location" # default: Location

    # Footer customization
    footer-text: "" # Leave empty for no footer, supports {version} placeholder
    footer-icon-url: "" # Small icon next to footer text

    # Thumbnail (small image on the right side of embed)
    thumbnail-url: "" # Leave empty for no thumbnail

    # Large image at bottom of embed
    image-url: "" # Leave empty for no image

  # Mention/ping settings
  mentions:
    enabled: false # default: false
    # Role ID to ping (right-click role in Discord -> Copy ID, requires Developer Mode)
    role-id: ""
    # User IDs to ping (comma-separated, e.g., "123456789,987654321")
    user-ids: ""
    # Message content before embed (where mentions appear)
    # Supports placeholders: {role_mention}, {user_mentions}, {player}, {item_type}
    content: "{role_mention} {user_mentions}"

  # Rate limiting to prevent Discord API abuse
  rate-limit:
    enabled: true # default: true
    max-per-minute: 30 # default: 30 (Discord limit is 30/minute per webhook)
    # When rate limited, alerts are queued and sent when possible
    queue-max-size: 100 # default: 100 (max queued alerts, oldest dropped if exceeded)
